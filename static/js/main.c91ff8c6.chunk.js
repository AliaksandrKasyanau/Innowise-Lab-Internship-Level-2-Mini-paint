(this["webpackJsonpmini-paint"]=this["webpackJsonpmini-paint"]||[]).push([[0],{53:function(t,e,n){},54:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){},67:function(t,e,n){"use strict";n.r(e);var a=n(1),s=n.n(a),o=n(27),c=n.n(o),i=(n(53),n(34)),r=(n(54),n(7)),u=n.n(r),l=n(15),h=n(16),d=n(8),v=n(23),f=n(10),p="SET_REF",b="PUSH_TO_UNDO",j="PUSH_TO_REDO",m="UNDO",g="REDO",O="SET_TOOL",x="SET_FILL_COLOR",w="SET_STROKE_COLOR",y="SET_LINE_WIDTH",k="SIGN_IN",T="SIGN_UP",E="SIGN_OUT",D="RESET_PASSW",M="SIGN_ERROR",C={setRef:function(t){return{type:p,payload:t}},undo:function(){return{type:m}},pushToRedo:function(t){return{type:j,payload:t}},pushToUndo:function(t){return{type:b,payload:t}},redo:function(){return{type:g}}},N={setFillColor:function(t){return{type:x,payload:t}},setTool:function(t){return{type:O,payload:t}},setStrokeColor:function(t){return{type:w,payload:t}},setLineWidth:function(t){return{type:y,payload:t}}},Y=n(26),S=(n(43),n(44),n(62),function(t){i.b.error(t,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}),A=function(t){i.b.success(t,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},R=(n(68),Y.a.initializeApp({apiKey:"AIzaSyBpslPOq-O0mZHCF_7vUcVfCUl8sHva6Y8",authDomain:"mini-paint-34610.firebaseapp.com",projectId:"mini-paint-34610",storageBucket:"mini-paint-34610.appspot.com",messagingSenderId:"303759504350",appId:"1:303759504350:web:80c47b93b7a8fac624a34f"})),X=Y.a.auth(),I=Y.a.firestore(),P=(R.firestore(),Y.a.storage().ref()),L=new Y.a.auth.GoogleAuthProvider,U=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.signInWithPopup(L);case 2:return e=t.sent,A("You are logged in!"),t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_=function(){var t=Object(l.a)(u.a.mark((function t(e,n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.createUserWithEmailAndPassword(e,n);case 2:return a=t.sent,A("Account has been created!"),A("You are logged in!"),t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),F=function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.signOut();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),G={canvasActions:C,toolsActions:N,authActions:{signIn:function(t){return{type:k,payload:t}},sign_out:function(){return{type:E}},sign_up:function(t){return{type:T,payload:t}},reset_passw:function(){return{type:D}},signin:function(t,e){return function(n){(function(t,e){return X.signInWithEmailAndPassword(t,e)})(t,e).then((function(t){var e=t.user;if(void 0!==e){var a=e.uid,s=e.email;n(G.authActions.signIn({uid:a,email:s})),A("You are logged in!")}})).catch((function(){n(G.authActions.sign_error()),S("Something went worng")}))}},signOut:function(){return function(t){F().then((function(){t(G.authActions.sign_out())}))}},signUp:function(t,e){return function(n){_(t,e).then((function(t){var e=t.user,a=e.uid,s=e.email;n(G.authActions.sign_up({uid:a,email:s}))})).catch((function(t){var e=t.message;S(e),n(G.authActions.sign_error())}))}},resetPassw:function(t){return function(e){(function(t){var e=X.sendPasswordResetEmail(t);return A("Please check your email!"),e})(t).then((function(){e(G.authActions.reset_passw())})).catch((function(t){var n=t.message;S(n),e(G.authActions.sign_error())}))}},signInGoogle:function(){return function(t){U().then((function(e){var n=e.user,a=n.uid,s=n.email;t(G.authActions.signIn({uid:a,email:s}))}))}},sign_error:function(){return{type:M}}}},W=n(2),B=function(){var t=Object(a.useState)(""),e=Object(v.a)(t,2),n=e[0],s=e[1],o=Object(f.b)();return Object(W.jsx)("div",{className:"auth-wrapper",children:Object(W.jsxs)("div",{className:"container",children:[Object(W.jsx)("div",{className:"icon",children:"autorenew"}),Object(W.jsx)("h1",{children:"Reset your Password"}),Object(W.jsxs)("div",{children:[Object(W.jsxs)("form",{className:"form",children:[Object(W.jsx)("input",{type:"email",name:"userEmail",id:"userEmail",value:n,placeholder:"Input your email",onChange:function(t){var e=t.currentTarget,n=e.name,a=e.value;"userEmail"===n&&s(a)},className:"input"}),Object(W.jsx)("button",{className:"button primary-button fp-button",onClick:function(){o(G.authActions.resetPassw(n)),s("")},children:"Send me a reset link"})]}),Object(W.jsx)(h.b,{to:"/",className:"link",children:"\u2190 back to sign in page"})]})]})})},H=(n(65),n(69)),V=n(70),z=n(71),J=function(){var t=Object(a.useState)(""),e=Object(v.a)(t,2),n=e[0],s=e[1],o=Object(a.useState)(""),c=Object(v.a)(o,2),i=c[0],r=c[1],u=Object(d.g)(),l=Object(f.b)(),p=function(t){var e=t.currentTarget,n=e.name,a=e.value;"userEmail"===n?s(a):"userPassword"===n&&r(a)};return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(H.a,{children:Object(W.jsx)(V.a,{children:Object(W.jsxs)(z.a,{className:"auth-wrapper",xs:12,children:[Object(W.jsx)("div",{className:"icon",children:"login"}),Object(W.jsx)("h1",{children:"Sign In"}),Object(W.jsxs)("form",{className:"form",children:[Object(W.jsx)("input",{type:"email",className:"input",name:"userEmail",value:n,placeholder:"Email",id:"userEmail",onChange:function(t){return p(t)}}),Object(W.jsx)("input",{type:"password",className:"input",name:"userPassword",value:i,placeholder:"Password",id:"userPassword",onChange:function(t){return p(t)}}),Object(W.jsx)(h.b,{to:"password-reset",className:"link",children:"Forgot Password?"}),Object(W.jsx)("button",{className:"button primary-button",onClick:function(){l(G.authActions.signin(n,i)),u.push("/")},children:"Sign In"})]}),Object(W.jsxs)("button",{className:"button google-button",onClick:function(){l(G.authActions.signInGoogle())},children:[" ","Sign in with Google"]}),Object(W.jsxs)("p",{children:["Don`t have an account?"," ",Object(W.jsx)(h.b,{to:"sign-up",className:"link",children:"Sign up"})," "]})]})})})})},K=function(){var t=Object(d.g)(),e=Object(a.useState)(""),n=Object(v.a)(e,2),s=n[0],o=n[1],c=Object(a.useState)(""),i=Object(v.a)(c,2),r=i[0],u=i[1],l=Object(a.useState)(""),p=Object(v.a)(l,2),b=p[0],j=p[1],m=Object(f.b)(),g=function(t){var e=t.currentTarget,n=e.name,a=e.value;"userEmail"===n?o(a):"userPassword"===n?u(a):"displayName"===n&&j(a)};return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(H.a,{children:Object(W.jsx)(V.a,{children:Object(W.jsxs)(z.a,{className:"auth-wrapper",xs:12,children:[Object(W.jsx)("div",{className:"icon",children:"how_to_reg"}),Object(W.jsx)("h1",{children:"Sign Up"}),Object(W.jsxs)("form",{className:"form",children:[Object(W.jsx)("input",{type:"text",className:"input",name:"displayName",value:b,placeholder:"Your Name",id:"displayName",onChange:g}),Object(W.jsx)("input",{type:"email",className:"input",name:"userEmail",value:s,placeholder:"Email",id:"userEmail",onChange:g}),Object(W.jsx)("input",{type:"password",className:"input",name:"userPassword",value:r,placeholder:"Password",id:"userPassword",onChange:g}),Object(W.jsx)("button",{className:"button primary-button",onClick:function(){m(G.authActions.signUp(s,r,b)),t.push("/")},children:"Sign Up"})]}),Object(W.jsx)("button",{onClick:function(){try{m(G.authActions.signInGoogle()),t.push("/")}catch(e){S("SignIn Error")}},className:"button google-button",children:"Sign In with Google"}),Object(W.jsxs)("p",{children:["Already have an account?"," ",Object(W.jsx)(h.b,{to:"/",className:"link",children:"Sign in here"})," "]})]})})})})};var q=function(){return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(d.d,{children:[Object(W.jsx)(d.b,{path:"/sign-in",component:J}),Object(W.jsx)(d.b,{path:"/sign-up",component:K}),Object(W.jsx)(d.b,{path:"/password-reset",component:B}),Object(W.jsx)(d.a,{from:"/",to:"/sign-in"})]})})},Z=n(6),Q=function(){var t=Object(l.a)(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",null);case 2:return t.prev=2,t.next=5,I.doc("users/".concat(e)).get();case 5:return n=t.sent,t.abrupt("return",Object(Z.a)({uid:e},n.data()));case 9:t.prev=9,t.t0=t.catch(2),console.error("Error fetching user",t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),$=function(){var t=Object(l.a)(u.a.mark((function t(e,n){var a,s,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return a=I.doc("users/".concat(e.uid)),t.next=5,a.get();case 5:if(t.sent.exists){t.next=16;break}return s=e.email,o=e.displayName,t.prev=8,t.next=11,a.set(Object(Z.a)({displayName:o,email:s},n));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(8),console.error("Error creating user document",t.t0);case 16:return t.abrupt("return",Q(e.uid));case 17:case"end":return t.stop()}}),t,null,[[8,13]])})));return function(e,n){return t.apply(this,arguments)}}();var tt=function(){var t=Object(l.a)(u.a.mark((function t(e,n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:P.child("images/"+n+"/").listAll().then(function(){var t=Object(l.a)(u.a.mark((function t(a){var s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=[],t.next=3,Promise.all(a.items.map(function(){var t=Object(l.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDownloadURL().then((function(t){s.push(t)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return t.next=5,e([].concat(s));case 5:P.child("images/"+n+"/");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function et(t,e){var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}));t.toBlob((function(t){(new Image).src=t;P.child("images/"+e+"/"+n).put(t,{contentType:"image/png"}).then((function(t){A("Uploaded "+t.totalBytes+" bytes.")})).catch((function(t){S("Upload failed: "+t)}))}))}var nt=function(){var t=Object(f.c)((function(t){return t.currentAuth})),e=Object(d.g)(),n=Object(a.useState)([]),s=Object(v.a)(n,2),o=s[0],c=s[1],i=t.user.uid;return Object(a.useEffect)((function(){(function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,tt(c,i);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("h1",{children:"Gallery"}),o.length>0?Object(W.jsx)("div",{className:"picture-list-wrapper",children:Object(W.jsx)("div",{className:"picture-list",id:"gallery",children:o.map((function(t,e){return Object(W.jsx)("img",{src:t,alt:""},e)}))})}):Object(W.jsx)("div",{className:"empty-list",children:Object(W.jsx)("h2",{children:"Gallery is empty"})}),Object(W.jsx)("button",{onClick:function(){e.push("/")},className:"gallery-back-btn",children:"Paint"})]})},at=(n(66),function(t){if(null!=t.current){var e=t.current.parentNode;t.current.width=parseInt(getComputedStyle(e).getPropertyValue("width")),t.current.height=parseInt(getComputedStyle(e).getPropertyValue("height")),console.log(t.current.height)}}),st=n(13),ot=n(14),ct=n(21),it=n(20),rt=function(){function t(e){if(Object(st.a)(this,t),this.canvas=void 0,this.context=void 0,null!=e){var n=e.getContext("2d");this.canvas=e,this.context=n,this.endListen()}}return Object(ot.a)(t,[{key:"endListen",value:function(){this.canvas.onmousedown=null,this.canvas.onmousemove=null,this.canvas.onmouseup=null,this.canvas.ontouchstart=null,this.canvas.ontouchend=null,this.canvas.ontouchend=null}},{key:"fillColor",set:function(t){this.context.fillStyle=t}},{key:"strokeColor",set:function(t){this.context.strokeStyle=t}},{key:"lineWidth",set:function(t){this.context.lineWidth=t}}]),t}(),ut=function(t){Object(ct.a)(n,t);var e=Object(it.a)(n);function n(t){var a;return Object(st.a)(this,n),(a=e.call(this,t)).mouseDown=void 0,a.listen(),a}return Object(ot.a)(n,[{key:"listen",value:function(){this.canvas.onmousedown=this.handleMouseDown.bind(this),this.canvas.onmousemove=this.handleMouseMove.bind(this),this.canvas.onmouseup=this.handleMouseUp.bind(this),this.canvas.ontouchstart=this.handleTouchDown.bind(this),this.canvas.ontouchmove=this.handleTouchMove.bind(this),this.canvas.ontouchend=this.handleTouchEnd.bind(this)}},{key:"handleMouseDown",value:function(t){var e,n;this.mouseDown=!0,null===(e=this.context)||void 0===e||e.beginPath(),null===(n=this.context)||void 0===n||n.moveTo(t.pageX-this.canvas.offsetLeft,t.pageY-this.canvas.offsetTop)}},{key:"handleMouseMove",value:function(t){this.mouseDown&&this.draw(t.pageX-this.canvas.offsetLeft,t.pageY-this.canvas.offsetTop)}},{key:"handleMouseUp",value:function(){this.mouseDown=!1}},{key:"handleTouchDown",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});this.canvas.dispatchEvent(n)}},{key:"handleTouchMove",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousemove",{clientX:e.clientX-this.canvas.clientLeft,clientY:e.clientY-this.canvas.clientTop});this.canvas.dispatchEvent(n)}},{key:"handleTouchEnd",value:function(t){t.preventDefault();var e=new MouseEvent("mouseup",{});this.canvas.dispatchEvent(e)}},{key:"draw",value:function(t,e){var n,a;this.context.globalCompositeOperation="source-over",null===(n=this.context)||void 0===n||n.lineTo(t,e),null===(a=this.context)||void 0===a||a.stroke(),console.log("Draw brush")}}]),n}(rt),lt=function(t){Object(ct.a)(n,t);var e=Object(it.a)(n);function n(t){var a;return Object(st.a)(this,n),(a=e.call(this,t)).mouseDown=void 0,a.startX=void 0,a.startY=void 0,a.currentX=void 0,a.currentY=void 0,a.saved=void 0,a.listen(),a}return Object(ot.a)(n,[{key:"listen",value:function(){this.canvas.onmousedown=this.handleMouseDown.bind(this),this.canvas.onmousemove=this.handleMouseMove.bind(this),this.canvas.onmouseup=this.handleMouseUp.bind(this),this.canvas.ontouchstart=this.handleTouchDown.bind(this),this.canvas.ontouchmove=this.handleTouchMove.bind(this),this.canvas.ontouchend=this.handleTouchEnd.bind(this)}},{key:"handleMouseDown",value:function(t){var e;this.mouseDown=!0,null===(e=this.context)||void 0===e||e.beginPath(),this.startX=t.pageX-this.canvas.offsetLeft,this.startY=t.pageY-this.canvas.offsetTop,this.saved=this.canvas.toDataURL()}},{key:"handleMouseMove",value:function(t){if(this.mouseDown){var e=t.pageX-this.canvas.offsetLeft,n=t.pageY-this.canvas.offsetTop,a=e-this.startX,s=n-this.startY;this.draw(this.startX,this.startY,a,s)}}},{key:"handleMouseUp",value:function(){this.mouseDown=!1}},{key:"handleTouchDown",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});this.canvas.dispatchEvent(n)}},{key:"handleTouchMove",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousemove",{clientX:e.clientX-this.canvas.clientLeft,clientY:e.clientY-this.canvas.clientTop});this.canvas.dispatchEvent(n)}},{key:"handleTouchEnd",value:function(t){t.preventDefault();var e=new MouseEvent("mouseup",{});this.canvas.dispatchEvent(e)}},{key:"draw",value:function(t,e,n,a){var s=this,o=new Image;o.src=this.saved,o.onload=function(){var c,i,r,u,l,h;s.context.globalCompositeOperation="source-over",null===(c=s.context)||void 0===c||c.clearRect(0,0,s.canvas.width,s.canvas.height),null===(i=s.context)||void 0===i||i.drawImage(o,0,0,s.canvas.width,s.canvas.height),null===(r=s.context)||void 0===r||r.beginPath(),null===(u=s.context)||void 0===u||u.rect(t,e,n,a),null===(l=s.context)||void 0===l||l.fill(),null===(h=s.context)||void 0===h||h.stroke()}}}]),n}(rt),ht=function(t){Object(ct.a)(n,t);var e=Object(it.a)(n);function n(t){var a;return Object(st.a)(this,n),(a=e.call(this,t)).mouseDown=void 0,a.startX=void 0,a.startY=void 0,a.saved=void 0,a.listen(),a}return Object(ot.a)(n,[{key:"listen",value:function(){this.canvas.onmousedown=this.handleMouseDown.bind(this),this.canvas.onmousemove=this.handleMouseMove.bind(this),this.canvas.onmouseup=this.handleMouseUp.bind(this),this.canvas.ontouchstart=this.handleTouchDown.bind(this),this.canvas.ontouchmove=this.handleTouchMove.bind(this),this.canvas.ontouchend=this.handleTouchEnd.bind(this)}},{key:"handleMouseDown",value:function(t){var e;this.mouseDown=!0,null===(e=this.context)||void 0===e||e.beginPath(),this.startX=t.pageX-this.canvas.offsetLeft,this.startY=t.pageY-this.canvas.offsetTop,this.saved=this.canvas.toDataURL()}},{key:"handleMouseMove",value:function(t){if(this.mouseDown){var e=t.pageX-this.canvas.offsetLeft,n=t.pageY-this.canvas.offsetTop,a=e-this.startX,s=n-this.startY,o=Math.pow(a*a+s*s,.5);this.draw(this.startX,this.startY,o)}}},{key:"handleMouseUp",value:function(){this.mouseDown=!1}},{key:"handleTouchDown",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});this.canvas.dispatchEvent(n)}},{key:"handleTouchMove",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousemove",{clientX:e.clientX-this.canvas.clientLeft,clientY:e.clientY-this.canvas.clientTop});this.canvas.dispatchEvent(n)}},{key:"handleTouchEnd",value:function(t){t.preventDefault();var e=new MouseEvent("mouseup",{});this.canvas.dispatchEvent(e)}},{key:"draw",value:function(t,e,n){var a=this,s=new Image;s.src=this.saved,s.onload=function(){var o,c,i,r,u,l;a.context.globalCompositeOperation="source-over",null===(o=a.context)||void 0===o||o.clearRect(0,0,a.canvas.width,a.canvas.height),null===(c=a.context)||void 0===c||c.drawImage(s,0,0,a.canvas.width,a.canvas.height),null===(i=a.context)||void 0===i||i.beginPath(),null===(r=a.context)||void 0===r||r.arc(t,e,n,0,2*Math.PI),null===(u=a.context)||void 0===u||u.fill(),null===(l=a.context)||void 0===l||l.stroke()}}}]),n}(rt),dt=function(t){Object(ct.a)(n,t);var e=Object(it.a)(n);function n(t){var a;return Object(st.a)(this,n),(a=e.call(this,t)).mouseDown=void 0,a.startX=void 0,a.startY=void 0,a.currentX=void 0,a.currentY=void 0,a.saved=void 0,a.listen(),a}return Object(ot.a)(n,[{key:"listen",value:function(){this.canvas.onmousedown=this.handleMouseDown.bind(this),this.canvas.onmousemove=this.handleMouseMove.bind(this),this.canvas.onmouseup=this.handleMouseUp.bind(this),this.canvas.ontouchstart=this.handleTouchDown.bind(this),this.canvas.ontouchmove=this.handleTouchMove.bind(this),this.canvas.ontouchend=this.handleTouchEnd.bind(this)}},{key:"handleMouseDown",value:function(t){var e,n;this.mouseDown=!0,null===(e=this.context)||void 0===e||e.beginPath(),this.currentX=t.pageX-this.canvas.offsetLeft,this.currentY=t.pageY-this.canvas.offsetTop,null===(n=this.context)||void 0===n||n.moveTo(this.currentX,this.currentY),this.saved=this.canvas.toDataURL()}},{key:"handleMouseMove",value:function(t){if(this.mouseDown){var e=t.pageX-this.canvas.offsetLeft,n=t.pageY-this.canvas.offsetTop;this.draw(e,n)}}},{key:"handleMouseUp",value:function(){this.mouseDown=!1}},{key:"handleTouchDown",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});this.canvas.dispatchEvent(n)}},{key:"handleTouchMove",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousemove",{clientX:e.clientX-this.canvas.clientLeft,clientY:e.clientY-this.canvas.clientTop});this.canvas.dispatchEvent(n)}},{key:"handleTouchEnd",value:function(t){t.preventDefault();var e=new MouseEvent("mouseup",{});this.canvas.dispatchEvent(e)}},{key:"draw",value:function(t,e){var n=this,a=new Image;a.src=this.saved,a.onload=function(){var s,o,c,i,r,u;n.context.globalCompositeOperation="source-over",null===(s=n.context)||void 0===s||s.clearRect(0,0,n.canvas.width,n.canvas.height),null===(o=n.context)||void 0===o||o.drawImage(a,0,0,n.canvas.width,n.canvas.height),null===(c=n.context)||void 0===c||c.beginPath(),null===(i=n.context)||void 0===i||i.moveTo(n.currentX,n.currentY),null===(r=n.context)||void 0===r||r.lineTo(t,e),null===(u=n.context)||void 0===u||u.stroke()}}}]),n}(rt),vt=function(t){Object(ct.a)(n,t);var e=Object(it.a)(n);function n(t){var a;return Object(st.a)(this,n),(a=e.call(this,t)).mouseDown=void 0,a.listen(),a}return Object(ot.a)(n,[{key:"listen",value:function(){this.canvas.onmousedown=this.handleMouseDown.bind(this),this.canvas.onmousemove=this.handleMouseMove.bind(this),this.canvas.onmouseup=this.handleMouseUp.bind(this),this.canvas.ontouchstart=this.handleTouchDown.bind(this),this.canvas.ontouchmove=this.handleTouchMove.bind(this),this.canvas.ontouchend=this.handleTouchEnd.bind(this)}},{key:"handleMouseDown",value:function(t){var e,n;this.mouseDown=!0,null===(e=this.context)||void 0===e||e.beginPath(),null===(n=this.context)||void 0===n||n.moveTo(t.pageX-this.canvas.offsetLeft,t.pageY-this.canvas.offsetTop)}},{key:"handleMouseMove",value:function(t){this.mouseDown&&this.draw(t.pageX-this.canvas.offsetLeft,t.pageY-this.canvas.offsetTop)}},{key:"handleMouseUp",value:function(){this.mouseDown=!1}},{key:"handleTouchDown",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});this.canvas.dispatchEvent(n)}},{key:"handleTouchMove",value:function(t){t.preventDefault();var e=t.touches[0],n=new MouseEvent("mousemove",{clientX:e.clientX-this.canvas.clientLeft,clientY:e.clientY-this.canvas.clientTop});this.canvas.dispatchEvent(n)}},{key:"handleTouchEnd",value:function(t){t.preventDefault();var e=new MouseEvent("mouseup",{});this.canvas.dispatchEvent(e)}},{key:"draw",value:function(t,e){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.context.globalCompositeOperation="destination-out",this.context.moveTo(t,e),this.context.arc(t,e,a,0,2*Math.PI,!1),this.context.fill(),null===(n=this.context)||void 0===n||n.stroke()}}]),n}(rt),ft=function(t){Object(ct.a)(n,t);var e=Object(it.a)(n);function n(t){var a;return Object(st.a)(this,n),(a=e.call(this,t)).draw(),a}return Object(ot.a)(n,[{key:"draw",value:function(){this.context.globalCompositeOperation="destination-out",this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.beginPath()}}]),n}(rt),pt={brush:n.p+"static/media/brush.e883c464.svg",circle:n.p+"static/media/circle.bcdffe73.svg",disk:n.p+"static/media/disk.4e36d248.svg",eraser:n.p+"static/media/eraser.ba621429.svg",line:n.p+"static/media/line.c0682632.svg",rectangle:n.p+"static/media/rectangle.f713332e.svg",redo:n.p+"static/media/redo.127486dd.svg",trash:n.p+"static/media/trash.156c9cc0.svg",undo:n.p+"static/media/undo.02761356.svg",save:n.p+"static/media/save.8b14ea83.svg",signOut:n.p+"static/media/signOut.9fbf96f0.svg"},bt=function(){var t=Object(f.b)(),e=Object(f.c)((function(t){return t.currentCanvas})),n=Object(f.c)((function(t){return t.currentAuth}));return Object(W.jsxs)("div",{className:"toolbar-container",children:[Object(W.jsx)("label",{children:"Fill Color"}),Object(W.jsx)("input",{type:"color",onChange:function(n){return function(n){e&&t(G.toolsActions.setFillColor(n.target.value))}(n)},title:"Fill Color"}),Object(W.jsx)("label",{children:"Stroke Color"}),Object(W.jsx)("input",{type:"color",onChange:function(n){return function(n){e&&t(G.toolsActions.setStrokeColor(n.target.value))}(n)},title:"Stroke Color"}),Object(W.jsx)("label",{children:"Line Width"}),Object(W.jsx)("br",{}),Object(W.jsx)("input",{className:"line-width",type:"number",min:1,max:30,defaultValue:1,title:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043b\u0438\u043d\u0438\u0438",onChange:function(n){return function(n){e&&t(G.toolsActions.setLineWidth(n.target.value))}(n)}}),Object(W.jsxs)("div",{className:"button-tools",children:[Object(W.jsx)("button",{onClick:function(){e&&t(G.toolsActions.setTool(new dt(e.current)))},children:Object(W.jsx)("img",{src:pt.line})}),Object(W.jsx)("button",{onClick:function(){e&&t(G.toolsActions.setTool(new ut(e.current)))},children:Object(W.jsx)("img",{src:pt.brush})}),Object(W.jsx)("button",{onClick:function(){e&&t(G.toolsActions.setTool(new lt(e.current)))},children:Object(W.jsx)("img",{src:pt.rectangle})}),Object(W.jsx)("button",{onClick:function(){e&&t(G.toolsActions.setTool(new ht(e.current)))},children:Object(W.jsx)("img",{src:pt.circle})}),Object(W.jsxs)("button",{onClick:function(){e&&t(G.canvasActions.undo())},children:[" ",Object(W.jsx)("img",{src:pt.undo})]}),Object(W.jsxs)("button",{onClick:function(){e&&t(G.canvasActions.redo())},children:[" ",Object(W.jsx)("img",{src:pt.redo})]}),Object(W.jsxs)("button",{onClick:function(){e&&t(G.toolsActions.setTool(new vt(e.current)))},children:[" ",Object(W.jsx)("img",{src:pt.eraser})]}),Object(W.jsxs)("button",{onClick:function(){e&&t(G.toolsActions.setTool(new ft(e.current)))},children:[" ",Object(W.jsx)("img",{src:pt.trash})]}),Object(W.jsxs)("button",{onClick:function(){if(e){var t=n.user.uid;et(e.current,t)}},children:[" ",Object(W.jsx)("img",{src:pt.save})]})]})]})},jt=function(){var t=Object(f.b)(),e=Object(d.g)(),n=Object(f.c)((function(t){return t.currentCanvas}));Object(a.useEffect)((function(){t(G.canvasActions.setRef(n.current))}),[]);var s=function(){var e;(null===(e=n.current)||void 0===e?void 0:e.toDataURL)&&t(G.canvasActions.pushToRedo(n.current.toDataURL()))};Object(a.useEffect)((function(){at(n)}),[]);return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("canvas",{onMouseDown:s,onTouchStart:s,ref:n,className:"canvas"}),Object(W.jsxs)("footer",{children:[Object(W.jsx)(bt,{}),Object(W.jsx)("button",{onClick:function(){e.push("/gallery")},children:"Gallery"}),Object(W.jsx)("button",{className:" sign-out",onClick:function(){t(G.authActions.signOut())},children:Object(W.jsx)("img",{src:pt.signOut})})]})]})};var mt=function(){return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(jt,{})})})};var gt=function(){return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(d.d,{children:[Object(W.jsx)(d.b,{path:"/gallery",component:nt}),Object(W.jsx)(d.b,{path:"/",component:mt})]})})};var Ot=function(){var t=Object(f.c)((function(t){return t.currentAuth})),e=Object(f.b)();return Object(a.useEffect)((function(){X.onAuthStateChanged(function(){var t=Object(l.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$(n);case 2:(a=t.sent)&&e(G.authActions.signIn(a));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[]),t.login?Object(W.jsx)("div",{className:"App",children:Object(W.jsx)(h.a,{children:Object(W.jsx)(gt,{})})}):Object(W.jsx)("div",{className:"App",children:Object(W.jsx)(h.a,{children:Object(W.jsx)(q,{})})})};var xt=function(){return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(i.a,{}),Object(W.jsx)(Ot,{})]})},wt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,72)).then((function(e){var n=e.getCLS,a=e.getFID,s=e.getFCP,o=e.getLCP,c=e.getTTFB;n(t),a(t),s(t),o(t),c(t)}))},yt=n(25),kt=n(42),Tt={canvasRef:null,undo:[],redo:[]},Et=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case p:return Object(Z.a)(Object(Z.a)({},t),{},{canvasRef:e.payload});case j:return Object(Z.a)(Object(Z.a)({},t),{},{redo:[].concat(Object(kt.a)(t.redo),[e.payload])});case b:return Object(Z.a)(Object(Z.a)({},t),{},{redo:[].concat(Object(kt.a)(t.undo),[e.payload])});case g:var n=t.canvasRef.getContext("2d");if(n.globalCompositeOperation="source-over",t.undo.length>0){var a=t.undo.pop();t.redo.push(t.canvasRef.toDataURL());var s=new Image;s.src=a,s.onload=function(){null===n||void 0===n||n.clearRect(0,0,t.canvasRef.width,t.canvasRef.height),null===n||void 0===n||n.drawImage(s,0,0,t.canvasRef.width,t.canvasRef.height)}}return Object(Z.a)({},t);case m:var o=t.canvasRef.getContext("2d");if(o.globalCompositeOperation="source-over",t.redo.length>0){var c=t.redo.pop();t.undo.push(t.canvasRef.toDataURL());var i=new Image;i.src=c,i.onload=function(){null===o||void 0===o||o.clearRect(0,0,t.canvasRef.width,t.canvasRef.height),null===o||void 0===o||o.drawImage(i,0,0,t.canvasRef.width,t.canvasRef.height)}}return Object(Z.a)({},t);default:return t}},Dt={tool:void 0},Mt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case O:return Object(Z.a)(Object(Z.a)({},t),{},{tool:e.payload});case x:return t.tool&&(t.tool.fillColor=e.payload),t;case w:return t.tool&&(t.tool.strokeColor=e.payload),t;case y:return t.tool&&(t.tool.lineWidth=e.payload),t;default:return t}},Ct={login:!1,user:null},Nt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case k:return Object(Z.a)(Object(Z.a)({},t),{},{login:!0,user:e.payload});case E:return Object(Z.a)(Object(Z.a)({},t),{},{login:!1,user:null});case D:return Object(Z.a)(Object(Z.a)({},t),{},{login:!1});case T:return Object(Z.a)(Object(Z.a)({},t),{},{login:!0,user:e.payload});case M:return Object(Z.a)(Object(Z.a)({},t),{},{login:!1});default:return t}},Yt=Object(yt.c)({currentCanvas:Et,currentTools:Mt,currentAuth:Nt}),St=n(47),At=Object(yt.d)(Yt,Object(yt.a)(St.a));c.a.render(Object(W.jsx)(s.a.StrictMode,{children:Object(W.jsx)(f.a,{store:At,children:Object(W.jsx)(xt,{})})}),document.getElementById("root")),wt()}},[[67,1,2]]]);
//# sourceMappingURL=main.c91ff8c6.chunk.js.map